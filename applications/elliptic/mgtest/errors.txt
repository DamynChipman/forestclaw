# Using rhschoice == 2
# Errors + timing results

32      1.3088e-03  1.6095e-03 3.1880e-03      0.0211863
64      3.2594e-04  4.0179e-04 8.0164e-04      0.0336092
128     8.1406e-05  1.0041e-04 2.0070e-04      0.249881
256     2.0347e-05  2.5100e-05 5.0193e-05      1.07872
512     5.0864e-06  6.2750e-06 1.2549e-05      4.73482
1024    1.2716e-06  1.5687e-06 3.1374e-06     20.8176
2048    3.1789e-07  3.9218e-07 7.8436e-07     88.0664
4096    7.9473e-08  9.8046e-08 1.9609e-07    313.473


----------------------------------------------
Using Huang-Greengard example  (not-centered)
rhs-choice = 1
----------------------------------------------
32      4.4322e-31  6.4618e-31 3.2942e-30       0.0219212
64      7.1177e-07  1.0397e-06 6.1476e-06       0.0734358
128     8.4758e-02  1.2389e-01 8.5327e-01       0.246393
256     6.3200e-02  9.2519e-02 9.9299e-01       1.12158
512     1.6240e-05  2.2856e-03 5.4629e-01       4.33217
1024    1.4752e-05  2.3347e-03 6.9649e-01      17.3957
2048    1.4732e-05  2.3462e-03 7.3865e-01      73.7588


32
64
128     8.4648e-02  1.2373e-01 8.4260e-01      0.249371
256     6.3398e-02  9.2808e-02 9.8702e-01      1.07908
512     1.6258e-05  2.2856e-03 5.3125e-01      4.28374
1024    1.4752e-05  2.3347e-03 6.8638e-01     17.1284
2048     


alpha = 2000

32       1.7806e-01  2.6022e-01 1.2760e+00
64       7.7847e-03  1.7349e-02 4.3290e-01
128      3.9454e-04  1.1941e-02 6.0748e-01
256      3.9307e-04  1.2088e-02 7.1108e-01
512      3.9278e-04  1.2124e-02 7.4006e-01
1024     3.9272e-04  1.2132e-02 7.4750e-01
2048     


------------------------------------------------------------------------------------------
                                   Monday June 17, 2019
------------------------------------------------------------------------------------------

# alpha = 10000
# x0,y0 = (0,0)
# mi,mj = (1,1)
# Domain : [-1,1]x[-1,1]


  32      2.8934e-03  4.2178e-03 1.9945e-02
  64      1.8073e-01  2.6436e-01 1.5985e+00
 128      2.4243e-03  7.5625e-03 4.2622e-01
 256      1.1826e-04  6.5588e-03 6.2885e-01
1024      1.1790e-04  6.6254e-03 7.1741e-01
2048      1.1783e-04  6.6414e-03 7.4171e-01
4096

# alpha = 1000
# x0,y0 = (0.5,0.5)
# mi,mj = 1,1
# Domain : [0,1]x[0,1]

   32     7.2251e-01  1.0541e+00 5.0502e+00
   64     9.2520e-03  1.3652e-02 8.2430e-02
  128     4.8665e-05  1.0621e-03 6.0067e-02
  256     1.1640e-05  2.5022e-04 1.8063e-02
  512     2.8772e-06  6.1684e-05 4.7052e-03
 1024     7.1742e-07  1.5368e-05 1.1881e-03
 2048     1.7923e-07  3.8386e-06 2.9778e-04


 ------------------------------------------------------------------------------------------
                                  Sunday September 1, 2019
------------------------------------------------------------------------------------------

Adding inhomogeneous boundary conditions

# Example 1
# alpha = 10000
# x0 = 0.5
# y0 = 0.5
# Dirichlet conditions
# Domain : [0,1]x[0,1]


16     1.1547e-02  1.6712e-02 6.2236e-02       0.0273874
32     7.2251e-01  1.0541e+00 5.0502e+00       0.0206228
64     9.2520e-03  1.3652e-02 8.2430e-02       0.0257154
128    4.8665e-05  1.0621e-03 6.0067e-02       0.0530823
256    1.1640e-05  2.5022e-04 1.8063e-02       0.114289
512    2.8772e-06  6.1684e-05 4.7052e-03       0.376837
1024   7.1742e-07  1.5368e-05 1.1881e-03       1.5477 
2048   1.7923e-07  3.8386e-06 2.9778e-04       7.57257
4096   4.4801e-08  9.5945e-07 7.4490e-05      29.2418

          Convergence rates
------------------------------------------------
   32/   16  -5.9674  -5.9790  -6.3424   0.4093
   64/   32   6.2871   6.2708   5.9370  -0.3184
  128/   64   7.5707   3.6841   0.4566  -1.0456
  256/  128   2.0638   2.0857   1.7335  -1.1064
  512/  256   2.0164   2.0202   1.9407  -1.7213
 1024/  512   2.0038   2.0050   1.9856  -2.0381
 2048/ 1024   2.0010   2.0013   1.9963  -2.2907
 4096/ 2048   2.0002   2.0003   1.9991  -1.9492
------------------------------------------------


# Example 1
# alpha = 10000
# x0 = 0
# y0 = 0
# Dirichlet conditions
# Domain : [-1,1]x[-1,1]
# 1x1 multi-block domain


16     4.1526e-10  6.5608e-10 4.1864e-09
32     1.1161e-02  1.6494e-02 7.9029e-02
64     7.1408e-01  1.0485e+00 6.1214e+00
128    8.1344e-03  2.3388e-02 9.6169e-01
256    1.2695e-02  2.5771e-02 1.3853e+00
512    1.2695e-02  2.5910e-02 1.6753e+00



# Example 1
# alpha = 10000
# x0 = 0
# y0 = 0
# Dirichlet conditions
# Domain : [-1,1]x[-1,1]
# 2x2 multi-block domain


8    1.1546e-02  1.6709e-02 6.2179e-02    0.0401041
16   7.2217e-01  1.0525e+00 4.9631e+00    0.0474719
32   9.5650e-03  1.9941e-02 4.8155e-01    0.0780267
64   6.3779e-04  1.8451e-02 9.1855e-01    0.148199
128  6.3007e-04  1.7897e-02 9.8063e-01    0.579313
256  6.2868e-04  1.7767e-02 9.9521e-01    3.40099
512  6.2840e-04  1.7735e-02 9.9881e-01   18.4839


------------------------------------------------------------------------------------------
                                  Friday September 6, 2019
------------------------------------------------------------------------------------------

# Example 1 - inhomogeneous boundary conditions fixed.
# alpha = 10000
# x0 = 0.5
# y0 = 0.5
# Dirichlet conditions
# Domain : [-1,1]x[-1,1]
# 1x1 multi-block domain

32    1.1573e-02  1.6868e-02 7.9610e-02
64    7.2267e-01  1.0559e+00 6.1329e+00
128   9.2266e-03  1.3529e-02 9.6235e-02
256   1.2176e-05  5.3103e-04 6.0067e-02
512   2.9124e-06  1.2511e-04 1.8063e-02
1024  7.1989e-07  3.0842e-05 4.7052e-03
2048  1.7951e-07  7.6839e-06 1.1881e-03
4096  4.4844e-08  1.9193e-06 2.9778e-04

          Convergence rates
---------------------------------------
   64/   32  -5.9645  -5.9680  -6.2675
  128/   64   6.2914   6.2863   5.9939
  256/  128   9.5656   4.6711   0.6800
  512/  256   2.0638   2.0856   1.7335
 1024/  512   2.0164   2.0202   1.9407
 2048/ 1024   2.0037   2.0050   1.9856
 4096/ 2048   2.0011   2.0013   1.9963
---------------------------------------



# Example 2 - inhomogeneous boundary conditions fixed.
# x0 = 0.5
# y0 = 0.5
# a = 1; b = 1
# Dirichlet conditions
# Domain : [-1,1]x[-1,1]
# 1x1 multi-block domain

32     1.5039e-03  1.9012e-03 4.6362e-03
64     3.7643e-04  4.7499e-04 1.1835e-03
128    9.4032e-05  1.1873e-04 2.9864e-04
256    2.3503e-05  2.9680e-05 7.4986e-05
512    5.8755e-06  7.4200e-06 1.8786e-05
1024   1.4689e-06  1.8550e-06 4.7014e-06
2048   3.6721e-07  4.6375e-07 1.1759e-06
4096   9.1803e-08  1.1594e-07 2.9406e-07

          Convergence rates
---------------------------------------
   64/   32   1.9983   2.0009   1.9699
  128/   64   2.0012   2.0002   1.9866
  256/  128   2.0003   2.0001   1.9937
  512/  256   2.0001   2.0000   1.9970
 1024/  512   2.0000   2.0000   1.9985
 2048/ 1024   2.0001   2.0000   1.9993
 4096/ 2048   2.0000   2.0000   1.9996
---------------------------------------

# (same example as above)  on 2x3 block domain

16      1.5039e-03  1.9012e-03 4.6362e-03
32      3.7643e-04  4.7499e-04 1.1835e-03
64      9.4032e-05  1.1873e-04 2.9864e-04
128     2.3503e-05  2.9680e-05 7.4986e-05
256     5.8755e-06  7.4200e-06 1.8786e-05
512     1.4689e-06  1.8550e-06 4.7014e-06
1024    3.6721e-07  4.6375e-07 1.1759e-06 
2048    9.1803e-08  1.1594e-07 2.9406e-07

          Convergence rates
---------------------------------------
   32/   16   1.9983   2.0009   1.9699
   64/   32   2.0012   2.0002   1.9866
  128/   64   2.0003   2.0001   1.9937
  256/  128   2.0001   2.0000   1.9970
  512/  256   2.0000   2.0000   1.9985
 1024/  512   2.0001   2.0000   1.9993
 2048/ 1024   2.0000   2.0000   1.9996
---------------------------------------



# Example 1 - Testing with variable coefficient
# alpha = 10000
# x0 = 0.5
# y0 = 0.5
# beta = 1
# Dirichlet conditions
# Domain : [-1,1]x[-1,1]
# 2x2 multi-block domain
# CONVERGES

16   1.1573e-02  1.6868e-02 7.9610e-02
32   7.2267e-01  1.0559e+00 6.1329e+00
64   9.2266e-03  1.3529e-02 9.6235e-02
128  1.2176e-05  5.3103e-04 6.0067e-02
256  2.9124e-06  1.2511e-04 1.8063e-02
512  7.1989e-07  3.0842e-05 4.7052e-03

          Convergence rates
---------------------------------------
   32/   16  -5.9645  -5.9680  -6.2675
   64/   32   6.2914   6.2863   5.9939
  128/   64   9.5656   4.6711   0.6800
  256/  128   2.0638   2.0856   1.7335
  512/  256   2.0164   2.0202   1.9407
---------------------------------------


# Example 2 - inhomogeneous boundary conditions fixed.
# x0 = 0.5
# y0 = 0.5
# a = 1; b = 1
# Mixed BC conditions : 1 2 1 1
# Domain : [-1,1]x[-1,1]
# 1x1 multi-block domain

32     1.6039e-03  1.9800e-03 4.6451e-03
64     4.0053e-04  4.9443e-04 1.1844e-03
128    1.0008e-04  1.2357e-04 2.9873e-04
256    2.5017e-05  3.0891e-05 7.4997e-05
512    6.2543e-06  7.7226e-06 1.8787e-05
1024   1.5636e-06  1.9306e-06 4.7015e-06
2048   3.9089e-07  4.8266e-07 1.1760e-06
4096   9.7722e-08  1.2066e-07 2.9406e-07

          Convergence rates
---------------------------------------
   64/   32   2.0016   2.0017   1.9716
  128/   64   2.0008   2.0004   1.9872
  256/  128   2.0002   2.0001   1.9939
  512/  256   2.0000   2.0000   1.9971
 1024/  512   2.0000   2.0000   1.9985
 2048/ 1024   2.0000   2.0000   1.9992
 4096/ 2048   2.0000   2.0001   1.9997
---------------------------------------



# Example 4
# x0 = y0 = 0;  
# Domain : [-1,1]x[-1,1]
# Beta = 1
# 1x1 multiblock
# Dirichlet conditions

32     2.0190e+00  2.7891e+00 7.7606e+00
64     6.2440e-01  8.6045e-01 2.4314e+00
128    9.7389e-03  1.3876e-02 8.1904e-02
256    1.0774e-04  6.7093e-04 8.2142e-03
512    2.6478e-05  1.6392e-04 2.0569e-03
1024   6.5969e-06  4.0757e-05 5.0708e-04
2048   1.6478e-06  1.0176e-05 1.2701e-04
4096   4.1188e-07  2.5430e-06 3.1750e-05

          Convergence rates
---------------------------------------
   64/   32   1.6931   1.6966   1.6744
  128/   64   6.0026   5.9544   4.8917
  256/  128   6.4981   4.3703   3.3177
  512/  256   2.0247   2.0332   1.9976
 1024/  512   2.0049   2.0079   2.0202
 2048/ 1024   2.0012   2.0019   1.9973
 4096/ 2048   2.0002   2.0006   2.0001
---------------------------------------


------------------------------------------------------------------------------------------
                                  Saturday September 7, 2019
------------------------------------------------------------------------------------------

# Example 4 - Stars - single grid
# eps_disk = 0.015625
#
#  m-polar  = 4
#  x0-polar = -0.4  0.4  -0.6     0.5
#  y0-polar = -0.4  0.4   0.6    -0.7
#  r0-polar =  0.2  0.35  0.425   0.25
#  r1-polar =  0.2  0.45  0.3     0.6
#  n-polar  =  4    6     5       8


# ------------------------
# Uniform, single grid.  
# DOES NOT CONVERGE
# ------------------------

32     5.6284e+00  8.2722e+00 4.8824e+01
64     9.1092e+00  1.1816e+01 4.9973e+01
128    3.7597e+00  5.6911e+00 2.3214e+01
256    1.0954e+00  1.8180e+00 1.2496e+01
512    1.2541e-01  1.9618e-01 1.1383e+00
1024   2.2418e-04  8.9552e-04 2.2494e-02
2048   6.6061e-05  2.1945e-04 5.1428e-03
4096   5.5774e-05  1.0718e-04 1.8158e-03  

          Convergence rates
---------------------------------------
   64/   32  -0.6946  -0.5144  -0.0336
  128/   64   1.2767   1.0540   1.1062
  256/  128   1.7792   1.6464   0.8935
  512/  256   3.1267   3.2121   3.4565
 1024/  512   9.1278   7.7752   5.6612
 2048/ 1024   1.7628   2.0288   2.1289
 4096/ 2048   0.2442   1.0339   1.5019
---------------------------------------

# ------------------------
# Adaptive
# ------------------------

# refinement/coarsening threshold : (1e-4, 2.5e-5)
# minlevel/maxlevel : (3/7)
# Refinement criteria : abs(q(i,j)) > threshold
# See .png files in Gallery



# ------------------------
# Uniform
# ------------------------
# Example 4 - Stars - single grid, single star
# eps_disk = 0.015625
#
# m-polar = 1
# x0-polar = 0.111       <----------- star near center
# y0-polar = 0.00345
# r0-polar = 0.4
# r1-polar = 0.45
# n-polar = 6
# CONVERGES

32    2.8378e+01  3.9283e+01 1.1234e+02
64    1.3443e+01  1.8019e+01 4.3830e+01
128   1.2010e+00  1.6906e+00 7.0973e+00
256   8.1865e-02  1.3728e-01 9.9532e-01
512   2.0071e-03  2.9712e-03 3.0937e-02
1024  4.9683e-05  3.0483e-04 5.3478e-03
2048  1.2343e-05  7.5341e-05 1.3008e-03
4096  3.0811e-06  1.8783e-05 3.2393e-04

         Convergence rates
---------------------------------------
   64/   32   1.0779   1.1244   1.3579
  128/   64   3.4845   3.4139   2.6266
  256/  128   3.8748   3.6223   2.8340
  512/  256   5.3501   5.5299   5.0078
 1024/  512   5.3362   3.2850   2.5323
 2048/ 1024   2.0091   2.0165   2.0395
 4096/ 2048   2.0022   2.0040   2.0056
---------------------------------------



# Example 4 - Stars - single grid, single star
# eps_disk = 0.015625
#
# Move star to edge so we test boundary conditions. 
#
# m-polar = 1
# x0-polar = -0.89123   <----------- star near left edge
# y0-polar = 0.00345
# r0-polar = 0.4
# r1-polar = 0.45
# n-polar = 6
# Dirichlet conditions
# CONVERGES


32      7.7445e+00  1.1885e+01 5.1902e+01
64      4.4209e+00  6.5833e+00 2.7444e+01
128     4.4653e-01  7.7146e-01 5.5362e+00
256     2.8612e-02  6.1147e-02 8.5492e-01
512     8.4768e-04  1.5904e-03 2.8778e-02
1024    2.9232e-05  2.3286e-04 5.3494e-03
2048    7.2628e-06  5.7576e-05 1.3012e-03
4096    1.8130e-06  1.4355e-05 3.2402e-04

          Convergence rates
---------------------------------------
   64/   32   1.0779   1.1244   1.3579
  128/   64   3.4845   3.4139   2.6266
  256/  128   3.8748   3.6223   2.8340
  512/  256   5.3501   5.5299   5.0078
 1024/  512   5.3362   3.2850   2.5323
 2048/ 1024   2.0091   2.0165   2.0395
 4096/ 2048   2.0022   2.0040   2.0056
---------------------------------------


# Example 4 - Stars - single grid, single star
# eps_disk = 0.015625
#
# Move star to edge so we test boundary conditions. 
#
# m-polar = 1
# x0-polar = 0.89123   <----------- star near right edge
# y0-polar = 0.00345
# r0-polar = 0.4
# r1-polar = 0.45
# n-polar = 6
# Dirichlet + Neumann conditions ("1 2 1 1")
# CONVERGES


32      8.7937e+00  1.2410e+01 5.2176e+01 
64      4.9944e+00  6.8685e+00 2.7632e+01
128     5.0959e-01  8.0082e-01 5.5530e+00
256     3.1142e-02  6.1877e-02 8.5569e-01  
512     9.5793e-04  1.6342e-03 2.8815e-02
1024    2.9285e-05  2.3286e-04 5.3494e-03
2048    7.2761e-06  5.7576e-05 1.3012e-03
4096    1.8164e-06  1.4355e-05 3.2402e-04

         Convergence rates
---------------------------------------
   64/   32   0.8162   0.8534   0.9170
  128/   64   3.2929   3.1004   2.3150
  256/  128   4.0324   3.6940   2.6981
  512/  256   5.0228   5.2427   4.8922
 1024/  512   5.0317   2.8110   2.4294
 2048/ 1024   2.0089   2.0159   2.0395
 4096/ 2048   2.0021   2.0039   2.0057
---------------------------------------


------------------------------------------------------------------------------------------
                                  Friday September 20, 2019
                                      (Meeting with Scott)
------------------------------------------------------------------------------------------


# Variable coefficient
# Example 2 with variable coefficient 2
# Does NOT CONVERGE


32    1.2546e-01  2.1498e-01 1.0798e+00
64    1.2605e-01  2.1770e-01 1.2077e+00
128   1.2621e-01  2.1854e-01 1.2909e+00
256   1.2625e-01  2.1879e-01 1.3469e+00


# Example 0; beta = 1
# Does NOT CONVERGE


32     1.0261e-12  1.4078e-12 3.2073e-12
64     2.9439e-12  4.0346e-12 1.0397e-11
128    9.2741e-12  1.3414e-11 4.0998e-11 
256    1.0518e-11  1.3757e-11 3.0233e-11


# Example 0; beta = cos*(pi*x)*sin(pi*y) + 2
# Does NOT CONVERGE

32   3.9238e-01  5.3393e-01 1.8128e+00
64   3.9438e-01  5.3796e-01 1.9420e+00
128  3.9488e-01  5.3896e-01 2.0045e+00
256  3.9500e-01  5.3921e-01 2.0350e+00


# Example 0; beta = 1 + x*y
# Does NOT CONVERGE

32   3.0613e-01  4.3950e-01 1.4582e+00   
64   3.0857e-01  4.4472e-01 1.6042e+00
128  3.0935e-01  4.4652e-01 1.7126e+00
256  3.0959e-01  4.4711e-01 1.7922e+00

32   3.0613e-01  4.3950e-01 1.4582e+00
64   3.0857e-01  4.4472e-01 1.6042e+00



------------------------------------------------------------------------------------------
                                  Sunday October 6, 2019
------------------------------------------------------------------------------------------
# Variable coefficient
# Example 0 with variable coefficient 2
# Fixed bug in storing beta in mgtest_apply_bc.f90
# Scott has ghost cells working
# First order convergence ? 


16     3.9843e-03  5.2294e-03 1.4555e-02
32     1.9991e-03  2.6377e-03 7.5422e-03
64     1.0007e-03  1.3232e-03 3.8382e-03
128    5.0047e-04  6.6249e-04 1.9361e-03
256    2.5026e-04  3.3143e-04 9.7228e-04
512    1.5105e-04  1.8928e-04 4.8721e-04
1024   1.8258e-01  2.4951e-01 6.6209e-01

          Convergence rates
---------------------------------------
   32/   16   0.9950   0.9874   0.9485
   64/   32   0.9983   0.9952   0.9746
  128/   64   0.9997   0.9981   0.9873
  256/  128   0.9999   0.9992   0.9937
  512/  256   0.7284   0.8082   0.9968
 1024/  512 -10.2393 -10.3644 -10.4083       <------ Not sure what happened here
---------------------------------------


------------------------------------------------------------------------------------------
                                  Monday October 7, 2019
------------------------------------------------------------------------------------------

# Variable coefficient
# Example 3 with variable coefficient 2
# Scott fixed bug in ThunderEgg
# Second order convergence up to  N = 256
# Probably need to adjust iteration count or something ...


32    6.6016e-05  7.6347e-05 1.6854e-04
64    1.6515e-05  1.9107e-05 4.3081e-05
128   4.1295e-06  4.7780e-06 1.0892e-05
256   1.0324e-06  1.1946e-06 2.7380e-06
512   1.8672e-06  2.4249e-06 5.5947e-06
1024  1.4393e-03  2.2250e-03 6.6538e-03


------------------------------------------------------------------------------------------
                                 Wednesday October 9, 2019
------------------------------------------------------------------------------------------

# Variable coefficient
# Example 3 with variable coefficient 2
# Scott fixed bug in ThunderEgg
# Second order convergence up to  N = 256
# Probably need to adjust iteration count or something ...
# Iteration count included below

N           1-norm       2-norm   inf-norm    iterations
--------------------------------------------------------
32       6.6016e-05  7.6347e-05 1.6854e-04            94
64       1.6515e-05  1.9107e-05 4.3081e-05           203
128      4.1295e-06  4.7780e-06 1.0892e-05           424
256      1.0324e-06  1.1946e-06 2.7380e-06           924
512      2.5811e-07  2.9865e-07 6.8638e-07          1928
1024     6.4527e-08  7.4662e-08 1.7183e-07          4758


          Convergence rates (with iteration count)
------------------------------------------------
   64/   32   1.9990   1.9985   1.9680  -1.1107
  128/   64   1.9997   1.9996   1.9838  -1.0626
  256/  128   2.0000   1.9999   1.9921  -1.1238
  512/  256   1.9999   2.0000   1.9960  -1.0611
 1024/  512   2.0000   2.0000   1.9980  -1.3033
------------------------------------------------



